<div class="estoque">
  <div class="estoque-header">
    <div class="header-content">
      <h2>Controle de Estoque</h2>
      <button pButton label="Nova Movimentação" icon="pi pi-plus" 
              class="p-button-primary" (click)="novaMovimentacao()"></button>
    </div>
  </div>

  <div class="estoque-content">
    <div class="estoque-stats">
      <div class="stat-card">
        <div class="stat-icon">
          <i class="pi pi-box"></i>
        </div>
        <div class="stat-content">
          <h3>Total em Estoque</h3>
          <p class="stat-value">1.234</p>
          <span class="stat-change">Itens disponíveis</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="pi pi-exclamation-triangle"></i>
        </div>
        <div class="stat-content">
          <h3>Estoque Baixo</h3>
          <p class="stat-value">15</p>
          <span class="stat-change negative">Produtos críticos</span>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon">
          <i class="pi pi-dollar"></i>
        </div>
        <div class="stat-content">
          <h3>Valor Total</h3>
          <p class="stat-value">R$ 45.230,00</p>
          <span class="stat-change">Em estoque</span>
        </div>
      </div>
    </div>

    <div class="estoque-table">
      <h3>Relatório de Estoque</h3>
      <p-table [value]="relatorioEstoque" [paginator]="true" [rows]="10" 
               [showCurrentPageReport]="true" [tableStyle]="{'min-width': '50rem'}"
               currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} produtos"
               [rowsPerPageOptions]="[10,25,50]">
        
        <ng-template pTemplate="header">
          <tr>
            <th>Produto</th>
            <th>Quantidade Atual</th>
            <th>Quantidade Mínima</th>
            <th>Status</th>
            <th>Última Movimentação</th>
            <th>Ações</th>
          </tr>
        </ng-template>
        
        <ng-template pTemplate="body" let-item>
          <tr>
            <td>
              <div class="produto-info">
                <strong>{{item.produto.nome}}</strong>
                <small>ID: {{item.produto.id}}</small>
              </div>
            </td>
            <td>
              <span [class]="getEstoqueClass(item.quantidadeAtual)">
                {{item.quantidadeAtual}}
              </span>
            </td>
            <td>{{item.quantidadeMinima}}</td>
            <td>
              <p-tag [value]="item.status" 
                     [severity]="getStatusSeverity(item.status)"></p-tag>
            </td>
            <td>{{item.ultimaMovimentacao | date:'dd/MM/yyyy HH:mm'}}</td>
            <td>
              <div class="table-actions">
                <button pButton icon="pi pi-plus" class="p-button-text p-button-success p-button-sm" 
                        pTooltip="Entrada" (click)="entradaEstoque(item)"></button>
                <button pButton icon="pi pi-minus" class="p-button-text p-button-warning p-button-sm" 
                        pTooltip="Saída" (click)="saidaEstoque(item)"></button>
                <button pButton icon="pi pi-eye" class="p-button-text p-button-sm" 
                        pTooltip="Histórico" (click)="verHistorico(item)"></button>
              </div>
            </td>
          </tr>
        </ng-template>
        
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="6" class="text-center">
              <div class="empty-state">
                <i class="pi pi-database"></i>
                <p>Nenhum produto em estoque</p>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
